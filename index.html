<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ceradon Architect - Offline Mission Planning</title>
  <link rel="stylesheet" href="assets/css/styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <header class="top-nav">
    <div class="brand">
      <div class="logo-dot" aria-hidden="true"></div>
      <span class="wordmark">Ceradon Architect</span>
    </div>
    <nav aria-label="Primary">
      <ul class="nav-links">
        <li><a href="/#/home" data-route="home">Home</a></li>
        <li><a href="/#/library" data-route="library">Parts Library</a></li>
        <li><a href="/#/platform" data-route="platform">Platform Designer</a></li>
        <li><a href="/#/mission" data-route="mission">Mission Planner</a></li>
        <li><a href="/#/comms" data-route="comms">Comms Validator</a></li>
        <li><a href="/#/export" data-route="export">Export</a></li>
      </ul>
    </nav>
    <button class="toggle" id="themeToggle" aria-label="Toggle light or dark theme">ðŸŒ™</button>
  </header>

  <div class="version-strip" aria-label="Application version and status">
    <span class="pill" id="appVersionBadge" data-app-version></span>
    <span class="pill success">Offline Ready</span>
    <span class="pill subtle" id="schemaHeaderBadge" data-schema-version></span>
  </div>

  <div class="context-bar" role="note">
    <p class="small">Offline-first mission planning tool for air-gapped environments. Design platforms, plan missions, validate comms â€” all in your browser with zero cloud dependencies.</p>
  </div>

  <main id="app" class="view-container">
    <!-- HOME -->
    <section id="home" class="view" aria-label="Home view">
      <div class="hero">
        <div>
          <p class="eyebrow">Offline Mission Planning Tool</p>
          <h1>Design. Validate. Deploy.</h1>
          <p class="lead">Build custom sUAS platforms, plan multi-day missions with logistics, and validate RF communications â€” entirely offline, entirely in your browser. No cloud, no APIs, no internet required.</p>
          <div class="hero-actions">
            <a class="btn primary" href="/#/library">Start with Parts Library</a>
            <button class="btn ghost" id="loadSampleMission">Load Sample Mission</button>
          </div>
          <p class="small muted">All data stays local. Export mission packages as JSON. Works in air-gapped environments.</p>
        </div>
      </div>

      <div class="modules-workflows" aria-label="Workflow overview">
        <div class="mw-card">
          <h3>Complete Offline Workflow</h3>
          <p class="small muted">Four integrated modules, one mission package.</p>
          <ul class="bullet-list modules-list">
            <li><strong>Parts Library:</strong> Manage COTS component catalogs. Import inventory from CSV, search 1000+ parts, track availability and specs.</li>
            <li><strong>Platform Designer:</strong> Build virtual platforms from components. Real-time physics validation with environmental derating for altitude, temperature, and weather.</li>
            <li><strong>Mission Planner:</strong> Define mission phases, calculate battery swaps, generate per-operator packing lists with terrain-adjusted weight limits.</li>
            <li><strong>Comms Validator:</strong> Analyze RF link budgets, check line-of-sight, recommend relay placement for coverage gaps.</li>
          </ul>
        </div>
        <div class="mw-card">
          <h3>Typical Workflow</h3>
          <p class="small muted">Follow this path or jump to any module.</p>
          <ul class="bullet-list">
            <li><strong>Step 1:</strong> Load your unit's inventory into Parts Library (or use sample catalog).</li>
            <li><strong>Step 2:</strong> Design platforms in Platform Designer â€” select components, validate physics.</li>
            <li><strong>Step 3:</strong> Plan your mission â€” define phases, calculate logistics, generate packing lists.</li>
            <li><strong>Step 4:</strong> Validate comms â€” check link budgets, identify coverage gaps, place relays.</li>
            <li><strong>Step 5:</strong> Export complete mission package as JSON for field deployment.</li>
          </ul>
          <p class="small muted">All modules read/write the same MissionProject JSON. Start anywhere, work in any order.</p>
        </div>
      </div>

      <div class="missionproject-callout" aria-label="Quick start guide">
        <h3>Quick Start</h3>
        <div class="quick-start-steps">
          <div class="qs-step">
            <strong>1. Parts Library</strong>
            <p class="small">Load COTS components or import your unit's inventory from CSV.</p>
            <a class="btn subtle" href="/#/library">Open Parts Library â†’</a>
          </div>
          <div class="qs-step">
            <strong>2. Platform Designer</strong>
            <p class="small">Build platforms from parts, validate thrust-to-weight and flight time.</p>
            <a class="btn subtle" href="/#/platform">Design Platform â†’</a>
          </div>
          <div class="qs-step">
            <strong>3. Mission Planner</strong>
            <p class="small">Define phases, calculate battery swaps, generate packing lists.</p>
            <a class="btn subtle" href="/#/mission">Plan Mission â†’</a>
          </div>
          <div class="qs-step">
            <strong>4. Comms Validator</strong>
            <p class="small">Check RF link budgets, validate line-of-sight, place relays.</p>
            <a class="btn subtle" href="/#/comms">Validate Comms â†’</a>
          </div>
          <div class="qs-step">
            <strong>5. Export</strong>
            <p class="small">Download complete mission package as JSON for field deployment.</p>
            <a class="btn subtle" href="/#/export">Export Package â†’</a>
          </div>
        </div>
      </div>

      <div class="missionproject-status" id="missionProjectStatusPanel" aria-live="polite">
        <div class="status-body">
          <p class="eyebrow">Current Project Status</p>
          <h3 id="statusProjectName">No project loaded</h3>
          <p class="small" id="statusProjectMeta">Load a sample project or import your own to get started.</p>
          <div class="status-meta-grid">
            <div>
              <p class="small muted">Schema</p>
              <strong id="statusSchemaVersion">v2.0.0</strong>
            </div>
            <div>
              <p class="small muted">Source</p>
              <strong id="statusProjectSource">Not loaded</strong>
            </div>
            <div>
              <p class="small muted">Last updated</p>
              <strong id="statusLastUpdated">Not set</strong>
            </div>
          </div>
        </div>
        <div class="status-actions" id="statusActions">
          <button class="btn primary" id="homeLoadDemo" data-default-label="Load sample project">Load sample project</button>
          <button class="btn ghost" id="homeImportProject">Import JSON</button>
          <button class="btn subtle" id="homeClearProject">Clear</button>
          <input type="file" id="homeImportProjectFile" accept="application/json" hidden>
        </div>
      </div>
    </section>

    <!-- PARTS LIBRARY -->
    <section id="library" class="view" aria-label="Parts Library" hidden>
      <div class="section-header">
        <p class="eyebrow">Module 1</p>
        <h2>Parts Library</h2>
        <p class="lead">Manage your COTS component catalog. Import unit inventory from CSV, search and filter parts, track availability and specifications.</p>
      </div>

      <div class="tool-panel">
        <div class="card">
          <h3>Import / Export</h3>
          <div class="action-row">
            <button class="btn primary" id="importCSV">Import CSV Inventory</button>
            <button class="btn ghost" id="loadSampleParts">Load Sample Catalog</button>
            <button class="btn subtle" id="exportPartsJSON">Export as JSON</button>
            <input type="file" id="csvFileInput" accept=".csv" hidden>
          </div>
          <p class="small muted" id="partsLibraryStatus">No parts loaded. Import a CSV or load sample catalog.</p>
        </div>

        <div class="card">
          <h3>Search & Filter</h3>
          <div class="form-grid">
            <label>Search parts
              <input type="text" id="partsSearch" placeholder="Search by name, manufacturer, or specs...">
            </label>
            <label>Category
              <select id="partsCategoryFilter">
                <option value="all">All Categories</option>
                <option value="airframes">Airframes</option>
                <option value="motors">Motors</option>
                <option value="escs">ESCs</option>
                <option value="batteries">Batteries</option>
                <option value="flight_controllers">Flight Controllers</option>
                <option value="radios">Radios</option>
                <option value="sensors">Sensors</option>
                <option value="accessories">Accessories</option>
              </select>
            </label>
          </div>
        </div>

        <div class="card">
          <h3>Parts Catalog</h3>
          <div id="partsGrid" class="parts-grid">
            <p class="small muted">No parts to display. Import or load sample catalog.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- PLATFORM DESIGNER -->
    <section id="platform" class="view" aria-label="Platform Designer" hidden>
      <div class="section-header">
        <p class="eyebrow">Module 2</p>
        <h2>Platform Designer</h2>
        <p class="lead">Build virtual UxS platforms from components. Real-time physics validation with environmental derating.</p>
      </div>

      <div class="tool-panel">
        <div class="card">
          <h3>Platform Configuration</h3>
          <div class="form-grid">
            <label>Platform Name
              <input type="text" id="platformName" placeholder="e.g., Long-Range Recon Quad">
            </label>
            <label>Platform Type
              <select id="platformType">
                <option value="multi-rotor">Multi-rotor</option>
                <option value="fixed-wing">Fixed-wing</option>
                <option value="vtol">VTOL</option>
              </select>
            </label>
          </div>
        </div>

        <div class="card">
          <h3>Environment</h3>
          <div class="form-grid">
            <label>Altitude (m)
              <input type="number" id="envAltitude" value="0" min="0" max="5000" step="100">
            </label>
            <label>Temperature (Â°C)
              <input type="number" id="envTemperature" value="20" min="-40" max="50" step="5">
            </label>
          </div>
        </div>

        <div class="card">
          <h3>Component Selection</h3>
          <p class="small muted">Select components from your Parts Library</p>
          <div id="componentSelection"></div>
        </div>

        <div class="card">
          <h3>Physics Validation</h3>
          <div id="validationResults"></div>
          <div class="action-row">
            <button class="btn primary" id="validatePlatform">Validate Design</button>
            <button class="btn ghost" id="savePlatform">Save Platform</button>
          </div>
        </div>
      </div>
    </section>

    <!-- MISSION PLANNER -->
    <section id="mission" class="view" aria-label="Mission Planner" hidden>
      <div class="section-header">
        <p class="eyebrow">Module 3</p>
        <h2>Mission Planner</h2>
        <p class="lead">Define mission phases, calculate battery swaps, generate per-operator packing lists with terrain-adjusted weight limits.</p>
      </div>

      <div class="tool-panel">
        <div class="card">
          <h3>Mission Details</h3>
          <div class="form-grid">
            <label>Mission Name
              <input type="text" id="missionName" placeholder="e.g., Ridge Reconnaissance - 48hr">
            </label>
            <label>Duration (hours)
              <input type="number" id="missionDuration" value="48" min="1" max="168" step="1">
            </label>
            <label>Terrain
              <select id="missionTerrain">
                <option value="urban">Urban</option>
                <option value="suburban">Suburban</option>
                <option value="rural">Rural</option>
                <option value="mountain">Mountain</option>
                <option value="desert">Desert</option>
              </select>
            </label>
            <label>Team Size
              <input type="number" id="teamSize" value="4" min="1" max="12" step="1">
            </label>
          </div>
        </div>

        <div class="card">
          <h3>Mission Phases</h3>
          <div id="phasesEditor"></div>
          <button class="btn subtle" id="addPhase">+ Add Phase</button>
        </div>

        <div class="card">
          <h3>Logistics Calculation</h3>
          <div id="logisticsResults"></div>
          <div class="action-row">
            <button class="btn primary" id="calculateLogistics">Calculate Logistics</button>
            <button class="btn ghost" id="downloadPackingLists">Download Packing Lists</button>
          </div>
        </div>
      </div>
    </section>

    <!-- COMMS VALIDATOR -->
    <section id="comms" class="view" aria-label="Comms Validator" hidden>
      <div class="section-header">
        <p class="eyebrow">Module 4</p>
        <h2>Comms Validator</h2>
        <p class="lead">Analyze RF link budgets, check line-of-sight, recommend relay placement for coverage gaps.</p>
      </div>

      <div class="tool-panel">
        <div class="card">
          <h3>Environment</h3>
          <div class="form-grid">
            <label>Terrain Type
              <select id="commsTerrain">
                <option value="open">Open</option>
                <option value="rural">Rural</option>
                <option value="suburban">Suburban</option>
                <option value="urban">Urban</option>
                <option value="dense_urban">Dense Urban</option>
              </select>
            </label>
            <label>Weather Conditions
              <select id="commsWeather">
                <option value="clear">Clear</option>
                <option value="light_rain">Light Rain</option>
                <option value="heavy_rain">Heavy Rain</option>
                <option value="snow">Snow</option>
                <option value="fog">Fog</option>
              </select>
            </label>
          </div>
        </div>

        <div class="card">
          <h3>Nodes</h3>
          <div id="nodesEditor"></div>
          <button class="btn subtle" id="addNode">+ Add Node</button>
        </div>

        <div class="card">
          <h3>Link Analysis</h3>
          <div id="linkAnalysisResults"></div>
          <div class="action-row">
            <button class="btn primary" id="analyzeLinks">Analyze Links</button>
            <button class="btn ghost" id="downloadCommsReport">Download Report</button>
          </div>
        </div>
      </div>
    </section>

    <!-- EXPORT -->
    <section id="export" class="view" aria-label="Export" hidden>
      <div class="section-header">
        <p class="eyebrow">Module 5</p>
        <h2>Export Mission Package</h2>
        <p class="lead">Download your complete mission package as JSON, GeoJSON, or CoT for field deployment.</p>
      </div>

      <div class="tool-panel">
        <div class="card">
          <h3>Current Mission Project</h3>
          <div id="exportSummary"></div>
        </div>

        <div class="card">
          <h3>Export Options</h3>
          <div class="action-row">
            <button class="btn primary" id="exportMissionJSON">Export MissionProject JSON</button>
            <button class="btn ghost" id="exportGeoJSON">Export GeoJSON</button>
            <button class="btn subtle" id="exportCoT">Export CoT Stub</button>
          </div>
        </div>

        <div class="card">
          <h3>Mission Project Viewer</h3>
          <textarea id="jsonViewer" class="json-editor" rows="20" readonly></textarea>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="footer-meta">
      <span data-app-version></span>
      <span class="divider">â€¢</span>
      <span data-schema-version></span>
    </div>
    <p class="small">Ceradon Architect â€” Offline-first mission planning for contested environments</p>
  </footer>

  <!-- Load offline modules first -->
  <script src="assets/js/parts_library.js"></script>
  <script src="assets/js/physics_engine.js"></script>
  <script src="assets/js/platform_designer.js"></script>
  <script src="assets/js/mission_planner.js"></script>
  <script src="assets/js/comms_validator.js"></script>
  <script src="assets/js/csv_importer.js"></script>

  <!-- Then load MissionProject store and main app -->
  <script src="assets/js/mission_project.js"></script>
  <script src="assets/js/app.js"></script>
</body>
</html>
